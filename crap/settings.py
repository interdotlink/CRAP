from typing import Optional

from .protocols.base_header import BaseHeader


class Settings:
    """
    Application settings
    """

    COS: Optional[int] = None
    DSCP: Optional[int] = None
    FRAME: BaseHeader
    INTERFACE: str = "veth0"
    PACKET_COUNT: int = 5
    PADDING: bool = True
    PCAP: Optional[str] = None
    QINQ: Optional[int] = None
    RX: bool = False
    UNICAST: bool = False
    VLAN: Optional[int] = None

    """
    Layer 2 constants
    """
    ARP_REQUEST: str = "who-has"
    ARP_REPLY: str = "is-at"

    CDP_DSAP: int = 0xAA
    CDP_SSAP: int = 0xAA
    CDP_CTRL: int = 0x03
    CDP_OUI: int = 0x0C
    CDP_CODE: int = 0x2000
    CDP_PAYLOAD: str = (
        "02b40bea000100065331000500c2436973636f20494f5320536f6674776172652c20"
        "433335363020536f667477617265202843333536302d414456495053455256494345"
        "534b392d4d292c2056657273696f6e2031322e322834342953452c2052454c454153"
        "4520534f4654574152452028666331290a436f707972696768742028632920313938"
        "362d3230303820627920436973636f2053797374656d732c20496e632e0a436f6d70"
        "696c6564205361742030352d4a616e2d30382030303a3135206279207765696c6975"
        "00060017636973636f2057532d43333536302d3234545300020011000000010101cc"
        "000400000000000300144661737445746865726e6574302f31330004000800000028"
        "0008002400000c011200000000ffffffff010220ff0000000000000018ba986880ff"
        "000000090004000a00060001000b0005010012000500001300050000160011000000"
        "010101cc000400000000001a00100000000100000000ffffffff"
    )

    CFM_PAYLOAD: str = (
        "4001064600000000000101200d546573744d414e616d655374720000000000000000"
        "00000000000000000000000000000000000000000000000000000000000000000000"
        "000000000000020001020400010101000e0c07686f73746e616d652e6c616200c236"
        "3aa1"
    )

    ETHERTYPE_CFM: int = 0x8902
    ETHERTYPE_LLDP: int = 0x88CC
    ETHERTYPE_MACSEC: int = 0x88E5
    ETHERTYPE_RARP: int = 0x8035
    ETHERTYPE_SLOW_PROTOCOLS = 0x8809
    ETHERTYPE_VLAN: int = 0x8100

    ISIS_AREA_ID: str = "49.0001"
    ISIS_CONTROL: int = 0x03
    ISIS_DSAP: int = 0xFE
    ISIS_PDU_P2P_HELLO: int = 17
    ISIS_SSAP: int = 0xFE

    LACP_PAYLOAD: str = (
        "01011491f40004961f506a8000000000124700000002140000000000000000000000"
        "0000003b000000031000020000000000000000000000000000000000000000000000"
        "00000000000000000000000000000000000000000000000000000000000000000000"
        "00000000000000"
    )

    LLC_PROTO_ID_CDP: int = 0x2000
    LLC_PROTO_ID_RPVSTP: int = 0x010B

    LLDP_PAYLOAD: str = (
        "02070400192fa7b28d040d0155706c696e6b20746f205331060200780a0c53322e63"
        "6973636f2e636f6d0cbe436973636f20494f5320536f6674776172652c2043333536"
        "3020536f667477617265202843333536302d414456495053455256494345534b392d"
        "4d292c2056657273696f6e2031322e322834342953452c2052454c4541534520534f"
        "4654574152452028666331290a436f707972696768742028632920313938362d3230"
        "303820627920436973636f2053797374656d732c20496e632e0a436f6d70696c6564"
        "205361742030352d4a616e2d30382030303a3135206279207765696c697508134769"
        "676162697445746865726e6574302f31330e0400140004fe060080c2010001fe0900"
        "120f0103c03600100000"
    )

    MAC_BDF_MICRO: str = "01:00:5E:90:00:01"
    MAC_BROADCAST: str = "FF:FF:FF:FF:FF:FF"
    MAC_CFM: str = "01:80:c2:00:00:32"
    """
    IANA unassigned unicast MAC
    https://www.iana.org/assignments/ethernet-numbers/ethernet-numbers.xhtml
    """
    MAC_HOST1: str = "00:03:00:00:00:01"
    MAC_HOST2: str = "00:03:00:00:00:02"
    MAC_ISIS_L1: str = "01:80:C2:00:00:14"
    MAC_ISIS_L2: str = "01:80:C2:00:00:15"
    MAC_LLDP: str = "01:80:C2:00:00:0E"
    MAC_MACSEC: str = "01:80:C2:00:00:03"
    MAC_MC_IPV4_ALL_NODES: str = "01:00:5E:00:00:01"
    MAC_MC_IPV4_EIGRP: str = "01:00:5E:00:00:0A"
    MAC_MC_IPV4_IGMPV3: str = "01:00:5E:00:00:16"
    MAC_MC_IPV4_OSPF: str = "01:00:5E:00:00:05"
    MAC_MC_IPV6_ALL_NODES: str = "33:33:00:00:00:01"
    MAC_MC_IPV6_EIGRP: str = "33:33:00:00:00:0A"
    MAC_MC_IPV6_MLDV2: str = "33:33:00:00:00:16"
    MAC_MC_IPV6_OSPF: str = "33:33:00:00:00:05"
    MAC_MC_VRRP: str = "01:00:5E:00:00:12"
    MAC_MSTP: str = "01:80:C2:00:00:08"
    MAC_MULTICAST: str = "01:00:0C:CC:CC:CC"
    MAC_RPVSTP: str = "01:00:0C:CC:CC:CD"
    MAC_RSTP: str = "01:80:C2:00:00:00"
    MAC_SLOW_PROTOCOLS: str = "01:80:C2:00:00:02"
    MAC_STP: str = MAC_RSTP
    MAC_VRRP_V4_VRID: str = "00:00:5E:00:01:"
    MAC_VRRP_V6_VRID: str = "00:00:5E:00:02:"
    MAC_ZEROS: str = "00:00:00:00:00:00"

    MACSEC_SCI: bytes = bytes.fromhex(''.join(MAC_HOST1.split(":")) + "0001")
    MACSEC_AN: int = 0
    MACSEC_PN: int = 1
    MACSEC_KEY: bytes = b'aaaaaaaaaaaaaaaa'
    MACSEC_ENCRYPT: bool = True
    MACSEC_SEND_SCI: bool = True
    MACSEC_ICVLEN: int = 16
    MACSEC_XPN_EN: bool = True
    MACSEC_SSCI: int = 0x7A30C118
    MACSEC_SALT: bytes = b'\xe6\x30\xe8\x1a\x48\xde\x86\xa2\x1c\x66\xfa\x6d'

    MSTP_BRDIGE_ID: int = 0x1000
    MSTP_BPDU_AGE: int = 0
    MSTP_BPDU_TYPE: int = 0x02
    MSTP_FLAGS: int = 0x7C
    MSTP_PORT_ID: int = 0x8001
    MSTP_ROOT_ID: int = 0x1000
    MSTP_STP_VERSION: int = 0x3
    MSTP_PAYLOAD: str = (
        "000003027c800000030000000100000000800000030000000180050000140002000f00"
        "0000500000000000000000000000000000000000000000000000000000000000000000"
        "00000055bf4e8a44b25d442868549c1bf7720f00030d408000001aa197d180137c8005"
        "00030000000100030d40808013"
    )

    RSTP_BRDIGE_ID: int = 0x8001
    RSTP_BPDU_AGE: int = 0
    RSTP_BPDU_TYPE: int = 0x02
    RSTP_FLAGS: int = 0x3C
    RSTP_PORT_ID: int = 0x8001
    RSTP_ROOT_ID: int = 0x8001
    RSTP_STP_VERSION: int = 0x2

    RPVSTP_BRDIGE_ID: int = 0x8005
    RPVSTP_BPDU_AGE: int = 0
    RPVSTP_BPDU_TYPE: int = 0x02
    RPVSTP_CODE: int = 0x010B
    RPVSTP_DSAP: int = 0xAA
    RPVSTP_FLAGS: int = 0x0E
    RPVSTP_OUI: int = 0x00000C
    RPVSTP_PORT_ID: int = 0x8001
    RPVSTP_ROOT_ID: int = 0x8005
    RPVSTP_SSAP: int = 0xAA
    RPVSTP_STP_VERSION: int = 0x2
    RPVSTP_TLV_LENGTH: str = "00"
    RPVSTP_TLV_ORIGIN: str = "000000020001"

    SLOW_PROTOCOLS_LACP: int = 0x01

    STP_AGE: int = 0
    STP_BRDIGE_ID: int = 0x8001
    STP_CTRL: int = 0x03
    STP_DSAP: int = 0x42
    STP_PORT_ID: int = 0x8001
    STP_ROOT_ID: int = 0x8001
    STP_SSAP: int = 0x42

    """
    Layer 3 constants
    """
    IPV4_HOST1: str = "10.200.200.1"
    IPV4_HOST1_LOOPBACK: str = "10.255.255.1"
    IPV4_HOST2: str = "10.200.200.2"
    IPV4_HOST2_LOOPBACK: str = "10.255.255.2"
    IPV4_HOST3: str = "10.200.200.3"
    IPV4_MASK: str = "255.255.255.252"
    IPV4_MASK_LEN: int = 30
    IPV4_MC_ALL_HOST: str = "224.0.0.1"
    IPV4_MC_EIGRP: str = "224.0.0.10"
    IPV4_MC_IGMPV3: str = "224.0.0.22"
    IPV4_MC_PRIV_GROUP: str = "239.0.0.1"
    IPV4_MC_OSPF: str = "224.0.0.5"
    IPV4_MC_VRRP: str = "224.0.0.18"
    IPV4_PROTO_EIGRP: int = 88
    IPV4_PROTO_VRRP: int = 112
    IPV4_SUBNET: str = "10.200.200.0"
    IPV6_HOST1: str = "FD00::0200:1"
    IPV6_HOST1_LL: str = "FE80::0200:1"
    IPV6_HOST2: str = "FD00::0200:2"
    IPV6_HOST2_LL: str = "FE80::0200:2"
    IPV6_HOST3: str = "FD00::0200:3"
    IPV6_MC_ALL_NODES: str = "FF02::1"
    IPV6_MC_EIGRP: str = "FF02::A"
    IPV6_MC_MLDV2: str = "FF02::16"
    IPV6_MC_OSPF: str = "FF02::5"
    IPV6_MC_VRRPV3: str = "FF02::12"
    IPV6_NH_EIGRP: int = 88
    IPV6_NH_VRRP: int = 112
    ICMPV6_TYPE_ECHO_REQ: str = "128"
    ICMPV6_TYPE_MLD_QUERY: str = "130"
    ICMPV6_TYPE_MLD_REPORTV2: str = "143"

    """
    Layer 4 constants
    """
    # BFD ports https://www.cisco.com/c/en/us/td/docs/routers/asr9000/software/asr9k-r7-5/routing/configuration/guide/b-routing-cg-asr9000-75x/implementing-BFD.html
    BFD_ASYNC_DST_PORT: int = 3784
    BFD_ASYNC_SRC_PORT: int = 49152
    BFD_CONTROL_DST_PORT: int = 3784
    BFD_CONTROL_SRC_PORT: int = 49152
    BFD_ECHO_DST_PORT: int = 3785
    BFD_ECHO_SRC_PORT: int = 3785
    BFD_MICRO_DST_PORT: int = 6784
    BFD_MICRO_SRC_PORT: int = 49344
    BGP_DST_PORT: int = 179
    BGP_SRC_PORT: int = 65000

    OSPF_MESSAGE_HELLO: int = 1
    OSPF_MESSAGE_UPDATE: int = 4
    OSPF_OPTION_V6: int = 1
    OSPF_OPTION_EXTERNAL: int = 2
    OSPF_OPTION_ROUTER: int = 16
    OSPF_OPTION_AF: int = 256
    VRRP_VRID: int = 1
